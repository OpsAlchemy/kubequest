
# my-app-deployment and cache-deployment deployed, and my-app-deployment deployment exposed through a service named my-app-service . Create a NetworkPolicy named my-app-network-policy to restrict incoming and outgoing traffic to my-app-deployment pods with the following specifications:

# Allow incoming traffic only from pods.
# Allow incoming traffic from a specific pod with the label app=trusted
# Allow outgoing traffic to pods.
# Deny all other incoming and outgoing traffic.



apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: my-app-network-policy
  # set this if my-app is not in default
  namespace: default
spec:
  # Select only the my-app pods (adjust labels to match your Deployment)
  podSelector:
    matchLabels:
      app: my-app
  policyTypes:
    - Ingress
    - Egress

  # Ingress: allow only from pods
  ingress:
    # allow from any pod in the same namespace
    - from:
        - podSelector: {}
    # also allow from pods labeled app=trusted in any namespace
    - from:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              app: trusted

  # Egress: allow only to pods, deny everything else
  egress:
    - to:
        # allow to pods in any namespace
        - podSelector: {}
