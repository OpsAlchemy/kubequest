# ------------------------------------------------------------
# Lab 01: Deploy nginx pod on controlplane only
# Problem Statement:
#   - Deploy a pod named "nginxpod" using image "nginx"
#   - Ensure the pod is scheduled on the controlplane node
#   - It must not run on worker nodes
# ------------------------------------------------------------

# ============================================================
# Solution 1: Taint Manipulation (for learning/demo only)
# ------------------------------------------------------------
# Remove taint from controlplane:
#   kubectl taint node k8s-master node-role.kubernetes.io/control-plane:NoSchedule-
# Add taint to workers:
#   kubectl taint node k8s-worker worker=NoSchedule
# After this, scheduler can place pod on controlplane.
# ============================================================
apiVersion: v1
kind: Pod
metadata:
  name: nginxpod-taint
  labels:
    app: nginx
spec:
  containers:
  - name: nginx
    image: nginx:latest
    resources:
      requests:
        cpu: "100m"
        memory: "128Mi"
      limits:
        cpu: "250m"
        memory: "256Mi"
    ports:
    - containerPort: 80
    - containerPort: 443

---
# ============================================================
# Solution 2: Direct nodeName Assignment (preferred for exam)
# ------------------------------------------------------------
# This method bypasses scheduler and directly assigns the pod
# to the controlplane node without changing taints.
# ============================================================
apiVersion: v1
kind: Pod
metadata:
  name: nginxpod-nodename
  labels:
    app: nginx
spec:
  nodeName: controlplane
  containers:
  - name: nginx
    image: nginx:latest
    resources:
      requests:
        cpu: "100m"
        memory: "128Mi"
      limits:
        cpu: "250m"
        memory: "256Mi"
    ports:
    - containerPort: 80
    - containerPort: 443
