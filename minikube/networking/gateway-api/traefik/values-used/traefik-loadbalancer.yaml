# traefik-values-lb.yaml
# Ready-to-use values for traefik chart (v3.x) for Minikube + MetalLB
# - LoadBalancer service (MetalLB will assign EXTERNAL-IP)
# - websecure -> 443 entrypoint
# - Gateway API provider enabled
# - config.http3 present so chart templates don't fail

providers:
  kubernetesGateway:
    enabled: true

log:
  level: INFO

# ensure templates referencing config.http3 don't fail
config:
  http3:
    enabled: false

ports:
  web:
    port: 80
    exposedPort: 80
    protocol: TCP
    exposed: true
  websecure:
    port: 443
    exposedPort: 443
    protocol: TCP
    exposed: true
  traefik:
    port: 8080
    exposedPort: 8080
    protocol: TCP
    exposed: true
  metrics:
    port: 9100
    exposedPort: 9100
    protocol: TCP
    exposed: true

additionalArguments:
  - "--entryPoints.web.address=:80/tcp"
  - "--entryPoints.websecure.address=:443/tcp"
  - "--entryPoints.websecure.http.tls=true"
  - "--providers.kubernetesgateway=true"
  - "--providers.kubernetescrd=true"
  - "--providers.kubernetesingress=true"
  - "--ping=true"
  - "--api.dashboard=true"

service:
  # Make Traefik LoadBalancer so MetalLB will allocate an EXTERNAL-IP
  type: LoadBalancer
  # Optional: uncomment + set to request a specific IP from MetalLB pool
  # loadBalancerIP: 192.168.39.240
  ports:
    traefik:
      port: 8080
      targetPort: traefik
    web:
      port: 80
      targetPort: web
    websecure:
      port: 443
      targetPort: websecure
    metrics:
      port: 9100
      targetPort: metrics

gateway:
  enabled: false

